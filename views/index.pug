extends layout
include mixins/movie_box.pug
include mixins/worst_movie_icon.pug
include mixins/best_movie_icon.pug

block styles
  link(rel="stylesheet" href="/stylesheets/style.css")

block content
  nav.navbar.sticky-top.navbar-expand-lg.navbar-dark.bg-dark
    a.navbar-brand(href="#") &#127909; Fantasy Movie League
    div.team-type.form-inline
      label Team: &nbsp;
        select.form-control#selected-team(onchange=`changeTeam(event, '${selectedSeason.slug}');`)
          each team in teams
            option(value= team.id selected= team.id === selectedTeam.slug)= team.name
    div.season-selector.form-inline
      label Season: &nbsp;
        select.form-control#selected-season(onchange="changeSeason(event)")
          each season in seasons
            option(value=season.slug selected= selectedSeason.slug === season.slug)= season.name
      
  div.main: div.row
    div.col-sm-4: div.container: div.row
      table.table.table-striped.table-hover
        thead.table-dark
          th Rank
          th Name
          th % Used
          th $/Share
          th Total
        tbody
          each player in standings
            tr
              td: span= player.rank
              td 
                span: a(href=`/players/${player.id}?team=${selectedTeam.id}`)= player.name
                if (player.bonus1)
                  +best_movie_icon()
                if (player.bonus2)
                  +worst_movie_icon()
              td(style={'text-align':'right'}): span= player.sharesUsed
              td(style={'text-align':'right'}): span= player.perShareDisp
              td(style={'text-align':'right'}): span= player.totalDisp
    div.col-sm-8: div.container 
      div.row
        div.dropdown
          button#sort.btn.btn-secondary.dropdown-toggle(type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false") Sort
          div.dropdown-menu
            a.dropdown-item(href="#" onclick="return sort(SORT.defaults.releaseDate)") Release Date
            a.dropdown-item(href="#" onclick="return sort(SORT.defaults.title)") Title
            a.dropdown-item(href="#" onclick="return sort(SORT.defaults.shares)") Shares
            a.dropdown-item(href="#" onclick="return sort(SORT.defaults.gross)") Gross
            a.dropdown-item(href="#" onclick="return sort(SORT.defaults.rating)") Rating
            a.dropdown-item(href="#" onclick="return sort(SORT.defaults.value)") Value
      div.row#movies
        each movie in earnings
          +movie_box(movie)
block scripts
  script(src="https://cdnjs.cloudflare.com/ajax/libs/tinysort/2.3.6/tinysort.min.js" integrity="sha256-5pgZzUdW0Qg53WkB5zljVnjT+jcQZY0dLUfoQZFxACo=" crossorigin="anonymous")
  script(src='/javascripts/index.js')